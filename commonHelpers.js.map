{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '44031619-a947df2c149ce3ba62f1c08d8';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nexport default class PixabayApi {\n  constructor() {\n    this.query = '';\n    this.page = 1;\n  }\n\n  async fetchPhoto() {\n    try {\n      const response = await axios.get(\n        `${BASE_URL}?key=${API_KEY}&q=${this.query}&image_type=photo&orientation=horizontal&safesearch=true&page=${this.page}&per_page=15`\n      );\n      this.incrementPage();\n      return response.data;\n    } catch (error) {\n      console.error('Error fetching data:', error);\n      throw error;\n    }\n  }\n\n  incrementPage() {\n    this.page += 1;\n  }\n\n  resetPage() {\n    this.page = 1;\n  }\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nlet lightbox;\n\nexport function onRenderGallery(images, container) {\n  const markup = images.map(image => createGalleryItem(image)).join('');\n  container.insertAdjacentHTML('beforeend', markup);\n\n  if (lightbox) {\n    lightbox.refresh();\n  } else {\n    lightbox = new SimpleLightbox('.gallery a');\n  }\n}\n\nfunction createGalleryItem(image) {\n  return `\n    <a href=\"${image.largeImageURL}\" class=\"image-card\">\n      <img src=\"${image.webformatURL}\" alt=\"${image.tags}\" loading=\"lazy\" />\n      <div class=\"info\">\n        <p class=\"info_p\">\n          <span class=\"label\">Likes:</span>\n          <span class=\"value\">${image.likes}</span>\n        </p>\n        <p class=\"info_p\">\n          <span class=\"label\">Views:</span>\n          <span class=\"value\">${image.views}</span>\n        </p>\n        <p class=\"info_p\">\n          <span class=\"label\">Comments:</span>\n          <span class=\"value\">${image.comments}</span>\n        </p>\n        <p class=\"info_p\">\n          <span class=\"label\">Downloads:</span>\n          <span class=\"value\">${image.downloads}</span>\n        </p>\n      </div>\n    </a>\n  `;\n}\n","import './css/styles.css';\nimport PixabayApi from './js/pixabay-api';\nimport { onRenderGallery } from './js/render-functions';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst refs = {\n  searchform: document.querySelector('.search-form'),\n  galleryContainer: document.querySelector('.gallery'),\n  loadMoreBtn: document.querySelector('.btn'),\n  loader: document.createElement('div'),\n};\n\nrefs.loader.className = 'loader';\ndocument.body.appendChild(refs.loader);\n\n// Сховати кнопку завантаження додаткових зображень при завантаженні сторінки\nrefs.loadMoreBtn.style.display = 'none';\n\nconst pixabayApi = new PixabayApi();\nlet totalHits = 0;\n\nrefs.searchform.addEventListener('submit', onSearch);\nrefs.loadMoreBtn.addEventListener('click', onLoadMore);\n\nfunction onSearch(event) {\n  event.preventDefault();\n\n  const query = event.currentTarget.elements.query.value.trim();\n  if (!query) {\n    return showToast('red', 'Please, fill the main field', 'topRight');\n  }\n\n  showLoader();\n  refs.galleryContainer.innerHTML = '';\n  refs.loadMoreBtn.style.display = 'none';\n  pixabayApi.query = query;\n  pixabayApi.resetPage();\n\n  fetchAndRenderImages(true);\n}\n\nasync function onLoadMore() {\n  showLoader();\n  await fetchAndRenderImages(false);\n  smoothScroll();\n}\n\nasync function fetchAndRenderImages(isNewSearch) {\n  try {\n    const data = await pixabayApi.fetchPhoto();\n    if (data.hits.length === 0) {\n      showToast(\n        'red',\n        'Sorry, there are no images matching your search query. Please try again!',\n        'topRight'\n      );\n    } else {\n      onRenderGallery(data.hits, refs.galleryContainer);\n      totalHits = isNewSearch ? data.totalHits : totalHits;\n      const loadedImages = pixabayApi.page * 15;\n      if (loadedImages >= totalHits) {\n        refs.loadMoreBtn.style.display = 'none';\n        showToast(\n          'blue',\n          \"We're sorry, but you've reached the end of search results.\",\n          'topRight'\n        );\n      } else {\n        refs.loadMoreBtn.style.display = 'block';\n      }\n    }\n  } catch (error) {\n    showToast(\n      'red',\n      'An error occurred while fetching images. Please try again later.',\n      'topRight'\n    );\n  } finally {\n    hideLoader();\n  }\n}\n\nfunction showToast(color, message, position = 'topRight') {\n  iziToast.show({\n    color: color,\n    message: message,\n    position: position,\n  });\n}\n\nfunction showLoader() {\n  refs.loader.style.display = 'block';\n}\n\nfunction hideLoader() {\n  refs.loader.style.display = 'none';\n}\n\nfunction smoothScroll() {\n  const { height: cardHeight } = document\n    .querySelector('.gallery')\n    .firstElementChild.getBoundingClientRect();\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n"],"names":["API_KEY","BASE_URL","PixabayApi","response","axios","error","lightbox","onRenderGallery","images","container","markup","image","createGalleryItem","SimpleLightbox","refs","pixabayApi","totalHits","onSearch","onLoadMore","event","query","showToast","showLoader","fetchAndRenderImages","smoothScroll","isNewSearch","data","hideLoader","color","message","position","iziToast","cardHeight"],"mappings":"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"}